/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const t="https://story-api.dicoding.dev/v1",e="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(){n=function(){return e};var t,e={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),c=new F(n||[]);return a(i,"_invoke",{value:j(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,s,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(A([])));E&&E!==o&&i.call(E,s)&&(k=E);var S=x.prototype=b.prototype=Object.create(k);function _(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,a,c,s){var u=p(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==r(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,s)}),(function(t){n("throw",t,c,s)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}})}function j(e,r,n){var o=d;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return w.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},_(O.prototype),f(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),f(S,l,"Generator"),f(S,s,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function o(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function c(t){o(a,n,i,c,s,"next",t)}function s(t){o(a,n,i,c,s,"throw",t)}c(void 0)}))}}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}var s={REGISTER:"".concat(t,"/register"),LOGIN:"".concat(t,"/login"),STORIES:"".concat(t,"/stories"),ADD_STORY:"".concat(t,"/stories")};const u=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getToken",value:function(){return localStorage.getItem("authToken")}},{key:"setToken",value:function(t){localStorage.setItem("authToken",t)}},{key:"removeToken",value:function(){localStorage.removeItem("authToken")}},{key:"isAuthenticated",value:function(){return!!this.getToken()}},{key:"register",value:(u=i(n().mark((function t(e){var r,o,i,a,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,o=e.email,i=e.password,t.prev=1,t.next=4,fetch(s.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,password:i})});case 4:return a=t.sent,t.next=7,a.json();case 7:if((c=t.sent).error){t.next=12;break}return t.abrupt("return",c);case 12:throw new Error(c.message);case 13:t.next=19;break;case 15:throw t.prev=15,t.t0=t.catch(1),console.error("Error registering:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[1,15]])}))),function(t){return u.apply(this,arguments)})},{key:"login",value:(c=i(n().mark((function t(e){var r,o,i,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,o=e.password,t.prev=1,t.next=4,fetch(s.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:o})});case 4:return i=t.sent,t.next=7,i.json();case 7:if((a=t.sent).error){t.next=13;break}return this.setToken(a.loginResult.token),t.abrupt("return",a.loginResult);case 13:throw new Error(a.message);case 14:t.next=20;break;case 16:throw t.prev=16,t.t0=t.catch(1),console.error("Error logging in:",t.t0),t.t0;case 20:case"end":return t.stop()}}),t,this,[[1,16]])}))),function(t){return c.apply(this,arguments)})},{key:"logout",value:function(){this.removeToken(),window.location.hash="#/login"}},{key:"getAllStories",value:(o=i(n().mark((function t(){var e,r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=this.getToken()){t.next=4;break}throw new Error("Please login first");case 4:return t.next=6,fetch("".concat(s.STORIES,"?location=1"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:return r=t.sent,t.next=9,r.json();case 9:if((o=t.sent).error){t.next=14;break}return t.abrupt("return",o.listStory);case 14:throw"Missing authentication"!==o.message&&"Invalid token signature"!==o.message||this.logout(),new Error(o.message);case 16:t.next=22;break;case 18:throw t.prev=18,t.t0=t.catch(0),console.error("Error fetching stories:",t.t0),t.t0;case 22:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(){return o.apply(this,arguments)})},{key:"addStory",value:(r=i(n().mark((function t(e){var r,o,i,a,c,u,l,f;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.description,o=e.photo,i=e.lat,a=e.lon,t.prev=1,c=this.getToken()){t.next=5;break}throw new Error("Please login first");case 5:return(u=new FormData).append("description",r),u.append("photo",o),i&&a&&(u.append("lat",i),u.append("lon",a)),t.next=11,fetch(s.ADD_STORY,{method:"POST",headers:{Authorization:"Bearer ".concat(c)},body:u});case 11:return l=t.sent,t.next=14,l.json();case 14:if((f=t.sent).error){t.next=19;break}return t.abrupt("return",f);case 19:throw"Missing authentication"!==f.message&&"Invalid token signature"!==f.message||this.logout(),new Error(f.message);case 21:t.next=27;break;case 23:throw t.prev=23,t.t0=t.catch(1),console.error("Error adding story:",t.t0),t.t0;case 27:case"end":return t.stop()}}),t,this,[[1,23]])}))),function(t){return r.apply(this,arguments)})}],e&&a(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,o,c,u}(),l={init:function(t){var e=this,r=t.button,n=t.nav;r.addEventListener("click",(function(t){e._toggleDrawer(t,n,r)})),document.addEventListener("click",(function(t){var o=n.contains(t.target),i=r.contains(t.target);o||i||!n.classList.contains("open")||e._closeDrawer(n,r)})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&n.classList.contains("open")&&(e._closeDrawer(n,r),r.focus())})),window.addEventListener("hashchange",(function(){n.classList.contains("open")&&e._closeDrawer(n,r),e._updateNavVisibility()})),document.addEventListener("click",(function(t){("logout-btn"===t.target.id||t.target.closest("#logout-btn"))&&(t.preventDefault(),confirm("Apakah Anda yakin ingin logout?")&&u.logout())})),document.addEventListener("keypress",(function(t){"Enter"!==t.key&&" "!==t.key||"logout-btn"!==t.target.id&&!t.target.closest("#logout-btn")||(t.preventDefault(),confirm("Apakah Anda yakin ingin logout?")&&u.logout())})),this._updateNavVisibility()},_updateNavVisibility:function(){var t=document.querySelectorAll(".auth-only"),e=u.isAuthenticated();t.forEach((function(t){t.style.display=e?"":"none"}))},_toggleDrawer:function(t,e,r){t.stopPropagation(),e.classList.contains("open")?this._closeDrawer(e,r):this._openDrawer(e,r)},_openDrawer:function(t,e){t.classList.add("open"),e.setAttribute("aria-expanded","true")},_closeDrawer:function(t,e){t.classList.remove("open"),e.setAttribute("aria-expanded","false")}};function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t,e,r){return(e=function(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},r))}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return(e=E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(){b=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new F(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function g(){}function w(){}function x(){}var k={};u(k,a,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(A([])));E&&E!==r&&n.call(E,a)&&(k=E);var S=x.prototype=g.prototype=Object.create(k);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},_(O.prototype),u(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),u(S,s,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function w(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function x(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){w(i,n,o,a,c,"next",t)}function c(t){w(i,n,o,a,c,"throw",t)}a(void 0)}))}}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}var S="favorites",_="offline-stories";const O=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.db=null},e=[{key:"init",value:(f=x(b().mark((function t(){var e=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open("storyshare-db",1);n.onerror=function(){console.error("IndexedDB error:",n.error),r(n.error)},n.onsuccess=function(){e.db=n.result,console.log("IndexedDB initialized successfully"),t(e.db)},n.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(S)||(e.createObjectStore(S,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1}),console.log("Favorites store created")),e.objectStoreNames.contains(_)||(e.createObjectStore(_,{keyPath:"id",autoIncrement:!0}).createIndex("createdAt","createdAt",{unique:!1}),console.log("Offline stories store created"))}})));case 1:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})},{key:"addFavorite",value:(l=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([S],"readwrite").objectStore(S),i=m(m({},e),{},{favoritedAt:(new Date).toISOString()}),a=o.add(i);a.onsuccess=function(){console.log("Story added to favorites:",e.id),t(e.id)},a.onerror=function(){console.error("Error adding to favorites:",a.error),n(a.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"removeFavorite",value:(u=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([S],"readwrite").objectStore(S).delete(e);o.onsuccess=function(){console.log("Story removed from favorites:",e),t(e)},o.onerror=function(){console.error("Error removing from favorites:",o.error),n(o.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getFavorites",value:(s=x(b().mark((function t(){var e,r=this,n=arguments;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:{},this.db){t.next=4;break}return t.next=4,this.init();case 4:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([S],"readonly").objectStore(S).getAll();o.onsuccess=function(){var r=o.result;if(e.search){var n=e.search.toLowerCase();r=r.filter((function(t){var e,r;return(null===(e=t.name)||void 0===e?void 0:e.toLowerCase().includes(n))||(null===(r=t.description)||void 0===r?void 0:r.toLowerCase().includes(n))}))}"name"===e.sortBy?r.sort((function(t,r){var n,o,i=(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())||"",a=(null===(o=r.name)||void 0===o?void 0:o.toLowerCase())||"";return"desc"===e.sortOrder?a.localeCompare(i):i.localeCompare(a)})):"date"===e.sortBy&&r.sort((function(t,r){var n=new Date(t.favoritedAt||t.createdAt),o=new Date(r.favoritedAt||r.createdAt);return"desc"===e.sortOrder?o-n:n-o})),t(r)},o.onerror=function(){console.error("Error getting favorites:",o.error),n(o.error)}})));case 5:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"isFavorite",value:(c=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([S],"readonly").objectStore(S).get(e);o.onsuccess=function(){t(!!o.result)},o.onerror=function(){console.error("Error checking favorite:",o.error),n(o.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"addOfflineStory",value:(a=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([_],"readwrite").objectStore(_),i=m(m({},e),{},{createdAt:(new Date).toISOString(),synced:!1,retryCount:0}),a=o.add(i);a.onsuccess=function(){console.log("Story saved for offline sync"),t(a.result)},a.onerror=function(){console.error("Error saving offline story:",a.error),n(a.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getOfflineStories",value:(i=x(b().mark((function t(){var e=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,r){var n=e.db.transaction([_],"readonly").objectStore(_).getAll();n.onsuccess=function(){t(n.result)},n.onerror=function(){console.error("Error getting offline stories:",n.error),r(n.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"clearSyncedStories",value:(o=x(b().mark((function t(){var e=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,r){var n=e.db.transaction([_],"readwrite").objectStore(_).clear();n.onsuccess=function(){console.log("Synced stories cleared"),t()},n.onerror=function(){console.error("Error clearing synced stories:",n.error),r(n.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"markStorySynced",value:(n=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([_],"readwrite").objectStore(_).delete(e);o.onsuccess=function(){console.log("Offline story marked as synced and removed:",e),t()},o.onerror=function(){console.error("Error marking story as synced:",o.error),n(o.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"incrementRetryCount",value:(r=x(b().mark((function t(e){var r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.init();case 3:return t.abrupt("return",new Promise((function(t,n){var o=r.db.transaction([_],"readwrite").objectStore(_),i=o.get(e);i.onsuccess=function(){var e=i.result;if(e){e.retryCount=(e.retryCount||0)+1,e.lastRetry=(new Date).toISOString();var r=o.put(e);r.onsuccess=function(){return t(e.retryCount)},r.onerror=function(){return n(r.error)}}else t(0)},i.onerror=function(){return n(i.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"close",value:function(){this.db&&(this.db.close(),this.db=null)}}],e&&k(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,c,s,u,l,f}());function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function P(){P=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new F(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==j(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(j(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),N(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;N(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function T(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return N(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?N(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function F(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){F(i,n,o,a,c,"next",t)}function c(t){F(i,n,o,a,c,"throw",t)}a(void 0)}))}}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function C(t){var e=function(t){if("object"!=j(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==j(e)?e:e+""}const q=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._map=null,this._markers=[],this._activeMarkerId=null},e=[{key:"getTemplate",value:function(){return'\n      <div class="stories-container">\n        \x3c!-- Stories Feed Section --\x3e\n        <div class="stories-section">\n          <div id="stories-list" class="stories-list" role="list"></div>\n        </div>\n\n        \x3c!-- Map Section --\x3e\n        <div class="map-section">\n          <div id="map" class="map-container" role="application" aria-label="Peta interaktif menampilkan lokasi cerita"></div>\n        </div>\n      </div>\n      \x3c!-- Image modal for HD view --\x3e\n      <div id="image-modal" class="image-modal hidden" aria-hidden="true">\n        <div class="image-modal-backdrop" data-modal-close></div>\n        <div class="image-modal-content" role="dialog" aria-modal="true">\n          <button class="modal-close" aria-label="Tutup gambar" data-modal-close>×</button>\n          <div id="modal-spinner" class="modal-spinner" aria-hidden="true"></div>\n          <img id="modal-image" src="" alt="" class="modal-image hidden" />\n        </div>\n      </div>\n    '}},{key:"showLoading",value:function(){var t=document.querySelector("#stories-list");t&&(t.innerHTML='\n        <div class="loading-spinner">\n          <div class="spinner"></div>\n          <p>Memuat cerita...</p>\n        </div>\n      ')}},{key:"showStories",value:(n=A(P().mark((function t(e){var r,n,o,i,a;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.querySelector("#stories-list")){t.next=4;break}return console.error("Element #stories-list not found"),t.abrupt("return");case 4:if(e&&0!==e.length){t.next=7;break}return r.innerHTML='\n        <div class="empty-state">\n          <p>Belum ada cerita yang dibagikan</p>\n          <a href="#/add-story" class="btn btn-primary">Tambah Cerita Pertama</a>\n        </div>\n      ',t.abrupt("return");case 7:n={},o=T(e),t.prev=9,o.s();case 11:if((i=o.n()).done){t.next=18;break}return a=i.value,t.next=15,O.isFavorite(a.id);case 15:n[a.id]=t.sent;case 16:t.next=11;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(9),o.e(t.t0);case 23:return t.prev=23,o.f(),t.finish(23);case 26:r.innerHTML=e.map((function(t){return'\n      <article class="story-card" data-story-id="'.concat(t.id,'">\n        <div class="story-image">\n          <img src="').concat(t.photoUrl,'" alt="').concat(t.name,'" loading="lazy" />\n          <button \n            class="favorite-btn ').concat(n[t.id]?"active":"",'"\n            data-story-id="').concat(t.id,'"\n            aria-label="').concat(n[t.id]?"Hapus dari favorit":"Tambah ke favorit",'"\n            title="').concat(n[t.id]?"Hapus dari favorit":"Tambah ke favorit",'"\n          >\n            <svg class="heart-icon" viewBox="0 0 24 24" fill="').concat(n[t.id]?"currentColor":"none",'" stroke="currentColor" stroke-width="2">\n              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>\n            </svg>\n          </button>\n        </div>\n        <div class="story-content">\n          <h3 class="story-title">').concat(t.name,'</h3>\n          <p class="story-description">').concat(t.description,'</p>\n          <div class="story-meta">\n            <span class="story-date">').concat(d(t.createdAt,"id-ID"),"</span>\n            ").concat(t.lat&&t.lon?'\n              <button class="story-location-btn" data-lat="'.concat(t.lat,'" data-lon="').concat(t.lon,'" aria-label="Lihat lokasi di peta">\n                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>\n                  <circle cx="12" cy="10" r="3"></circle>\n                </svg>\n                Lihat di Peta\n              </button>\n            '):"","\n          </div>\n        </div>\n      </article>\n    ")})).join(""),this._initializeMap(e),this._setupEventListeners(e);case 29:case"end":return t.stop()}}),t,this,[[9,20,23,26]])}))),function(t){return n.apply(this,arguments)})},{key:"_setupEventListeners",value:function(t){var e=this;document.querySelectorAll(".story-location-btn").forEach((function(t){t.addEventListener("click",(function(r){r.stopPropagation();var n=parseFloat(t.dataset.lat),o=parseFloat(t.dataset.lon);e._focusLocation(n,o)}))})),document.querySelectorAll(".favorite-btn").forEach((function(r){r.addEventListener("click",function(){var n=A(P().mark((function n(o){var i,a;return P().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.stopPropagation(),i=r.dataset.storyId,!(a=t.find((function(t){return t.id===i})))){n.next=6;break}return n.next=6,e._toggleFavorite(r,a);case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}))}},{key:"_toggleFavorite",value:(r=A(P().mark((function t(e,r){return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.classList.contains("active")){t.next=13;break}return t.next=5,O.removeFavorite(r.id);case 5:e.classList.remove("active"),e.setAttribute("aria-label","Tambah ke favorit"),e.setAttribute("title","Tambah ke favorit"),e.querySelector(".heart-icon").setAttribute("fill","none"),this._showToast("Dihapus dari favorit","info"),t.next=21;break;case 13:return t.next=15,O.addFavorite(r);case 15:e.classList.add("active"),e.setAttribute("aria-label","Hapus dari favorit"),e.setAttribute("title","Hapus dari favorit"),e.querySelector(".heart-icon").setAttribute("fill","currentColor"),this._showToast("Ditambahkan ke favorit","success");case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(0),console.error("Error toggling favorite:",t.t0),this._showToast("Gagal mengubah favorit","error");case 27:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(t,e){return r.apply(this,arguments)})},{key:"_showToast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="toast-notification ".concat(e),r.textContent=t,document.body.appendChild(r),setTimeout((function(){r.classList.add("show")}),100),setTimeout((function(){r.classList.remove("show"),setTimeout((function(){return r.remove()}),300)}),3e3)}},{key:"_initializeMap",value:function(t){var e=this;if(document.querySelector("#map")){this._map||(this._map=L.map("map").setView([-2.5,118],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",maxZoom:19}).addTo(this._map)),this._markers.forEach((function(t){return t.remove()})),this._markers=[];var r=t.filter((function(t){return t.lat&&t.lon}));if(0!==r.length&&(r.forEach((function(t){var r=L.marker([t.lat,t.lon]).addTo(e._map).bindPopup('\n          <div class="marker-popup">\n            <img src="'.concat(t.photoUrl,'" alt="').concat(t.name,'" class="popup-image" />\n            <h4>').concat(t.name,"</h4>\n            <p>").concat(t.description.substring(0,100)).concat(t.description.length>100?"...":"","</p>\n            <small>").concat(d(t.createdAt,"id-ID"),"</small>\n          </div>\n        "));e._markers.push(r)})),r.length>0)){var n=L.featureGroup(this._markers);this._map.fitBounds(n.getBounds().pad(.1))}}}},{key:"_focusLocation",value:function(t,e){this._map&&(this._map.setView([t,e],15),document.querySelector("#map").scrollIntoView({behavior:"smooth",block:"center"}))}},{key:"highlightStory",value:function(t){t.lat&&t.lon&&this._map&&this._focusLocation(t.lat,t.lon)}},{key:"showError",value:function(t){var e=document.querySelector("#stories-list");e&&(e.innerHTML='\n        <div class="error-state">\n          <p>❌ '.concat(t,'</p>\n          <button onclick="location.reload()" class="btn btn-primary">Muat Ulang</button>\n        </div>\n      '))}}],e&&G(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function D(){D=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==I(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(I(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function M(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function H(t){var e=function(t){if("object"!=I(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==I(e)?e:e+""}const R=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e},e=[{key:"loadStories",value:(r=D().mark((function t(){var e;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view.showLoading(),t.next=4,u.getAllStories();case 4:e=t.sent,this._view.showStories(e),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this._view.showError(t.t0.message);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){M(i,n,o,a,c,"next",t)}function c(t){M(i,n,o,a,c,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"handleStoryClick",value:function(t,e){var r=e.find((function(e){return e.id===t}));r&&this._view.highlightStory(r)}}],e&&B(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function Y(){Y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==z(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(z(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function U(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function V(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){U(i,n,o,a,c,"next",t)}function c(t){U(i,n,o,a,c,"throw",t)}a(void 0)}))}}function W(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J(n.key),n)}}function J(t){var e=function(t){if("object"!=z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:e+""}const K=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new q,this._presenter=new R(this._view)},e=[{key:"render",value:(n=V(Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._view.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=V(Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,100)}));case 2:return t.next=4,this._presenter.loadStories();case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&W(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function $(t){var e=function(t){if("object"!=Q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Q(e)?e:e+""}const X=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._map=null,this._selectedLocation=null,this._marker=null,this._stream=null},e=[{key:"getTemplate",value:function(){return'\n      <section class="container">\n        <div class="form-container">\n          <h1 class="form-title">Tambah Cerita Baru</h1>\n          <p class="form-subtitle">Bagikan pengalaman dan cerita menarik Anda</p>\n\n          <form id="add-story-form" class="story-form" novalidate>\n            \x3c!-- Description --\x3e\n            <div class="form-group">\n              <label for="description" class="form-label">\n                Cerita Anda <span class="required" aria-label="wajib diisi">*</span>\n              </label>\n              <textarea \n                id="description" \n                name="description" \n                class="form-control" \n                rows="5" \n                placeholder="Ceritakan pengalaman Anda (minimal 10 karakter)..."\n                required\n                aria-required="true"\n                aria-describedby="description-error"\n              ></textarea>\n              <div id="description-error" class="error-message" role="alert" aria-live="polite"></div>\n              <div class="char-counter">\n                <span id="char-count">0</span> karakter\n              </div>\n            </div>\n\n            \x3c!-- Photo Upload --\x3e\n            <div class="form-group">\n              <label for="photo" class="form-label">\n                Foto <span class="required" aria-label="wajib diisi">*</span>\n              </label>\n              \n              <div class="photo-upload-section">\n                \x3c!-- Camera Option --\x3e\n                <div class="camera-section">\n                  <button \n                    type="button" \n                    id="open-camera-btn" \n                    class="btn btn-secondary"\n                    aria-label="Buka kamera untuk mengambil foto"\n                  >\n                    Ambil dari Kamera\n                  </button>\n                  \n                  <div id="camera-container" class="camera-container hidden">\n                    <video id="camera-video" class="camera-video" autoplay playsinline aria-label="Preview kamera"></video>\n                    <div class="camera-controls">\n                      <button \n                        type="button" \n                        id="capture-btn" \n                        class="btn btn-primary"\n                        aria-label="Ambil foto"\n                      >\n                        Ambil Foto\n                      </button>\n                      <button \n                        type="button" \n                        id="close-camera-btn" \n                        class="btn btn-danger"\n                        aria-label="Tutup kamera"\n                      >\n                        ✖ Tutup Kamera\n                      </button>\n                    </div>\n                  </div>\n                  \n                  <canvas id="camera-canvas" class="hidden"></canvas>\n                </div>\n\n                \x3c!-- File Upload Option --\x3e\n                <div class="file-upload-section">\n                  <label for="photo" class="file-upload-label">\n                    <span class="upload-icon"></span>\n                    <span class="upload-text">Pilih dari File</span>\n                  </label>\n                  <input \n                    type="file" \n                    id="photo" \n                    name="photo" \n                    class="file-input" \n                    accept="image/jpeg,image/jpg,image/png"\n                    required\n                    aria-required="true"\n                    aria-describedby="photo-error"\n                  />\n                </div>\n              </div>\n\n              <div id="photo-error" class="error-message" role="alert" aria-live="polite"></div>\n              \n              \x3c!-- Photo Preview --\x3e\n              <div id="photo-preview-container" class="photo-preview-container hidden">\n                <img id="photo-preview" src="" alt="Preview foto yang akan diunggah" class="photo-preview" />\n                <button \n                  type="button" \n                  id="remove-photo-btn" \n                  class="btn-remove-photo"\n                  aria-label="Hapus foto"\n                >\n                  ✖\n                </button>\n              </div>\n            </div>\n\n            \x3c!-- Location Selection --\x3e\n            <div class="form-group">\n              <label for="map-picker" class="form-label">\n                Pilih Lokasi <span class="required" aria-label="wajib diisi">*</span>\n              </label>\n              <p class="form-help">\n                Klik pada peta untuk memilih lokasi cerita Anda.\n                <span class="keyboard-hint">Gunakan Tab untuk fokus ke peta, lalu klik untuk memilih lokasi.</span>\n              </p>\n              <div\n                id="map-picker"\n                class="map-picker"\n                role="application"\n                aria-label="Peta untuk memilih lokasi cerita. Klik pada peta untuk memilih lokasi."\n                tabindex="0"\n              ></div>\n              <div id="location-error" class="error-message" role="alert" aria-live="polite"></div>\n              <div id="selected-location" class="selected-location hidden">\n                <span class="location-icon"></span>\n                <span id="location-text"></span>\n              </div>\n            </div>\n\n            \x3c!-- Submit Button --\x3e\n            <div class="form-actions">\n              <button \n                type="submit" \n                id="submit-btn" \n                class="btn btn-primary btn-large"\n                aria-label="Kirim cerita"\n              >\n                Bagikan Cerita\n              </button>\n              <a href="#/" class="btn btn-secondary btn-large">Batal</a>\n            </div>\n\n            \x3c!-- Form Messages --\x3e\n            <div id="form-message" class="form-message hidden" role="alert" aria-live="assertive"></div>\n          </form>\n        </div>\n      </section>\n    '}},{key:"initializeMap",value:function(){var t=this;this._map&&this._map.remove(),this._map=L.map("map-picker").setView([-2.5489,118.0149],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(this._map),this._map.on("click",(function(e){t._selectLocation(e.latlng)}))}},{key:"_selectLocation",value:function(t){this._selectedLocation=t,this._marker&&this._map.removeLayer(this._marker),this._marker=L.marker(t).addTo(this._map);var e=document.querySelector("#location-text"),r=document.querySelector("#selected-location"),n=document.querySelector("#location-error");e&&r&&(e.textContent="Lat: ".concat(t.lat.toFixed(6),", Lon: ").concat(t.lng.toFixed(6)),r.classList.remove("hidden")),n&&(n.textContent="")}},{key:"getSelectedLocation",value:function(){return this._selectedLocation}},{key:"showValidationError",value:function(t){var e=document.querySelector("#form-message");e&&(e.className="form-message error-message",e.textContent=t,e.classList.remove("hidden"),e.focus())}},{key:"showError",value:function(t){this.showValidationError(t);var e=document.querySelector("#submit-btn");e&&(e.disabled=!1,e.textContent="Bagikan Cerita")}},{key:"showSubmitting",value:function(){var t=document.querySelector("#submit-btn"),e=document.querySelector("#form-message");t&&(t.disabled=!0,t.textContent="Mengirim..."),e&&e.classList.add("hidden")}},{key:"showSuccess",value:function(t){var e=document.querySelector("#form-message");e&&(e.className="form-message success-container",e.textContent=t,e.classList.remove("hidden"),e.focus());var r=document.querySelector("#add-story-form");r&&r.querySelectorAll("input, textarea, button").forEach((function(t){return t.disabled=!0}))}},{key:"getStream",value:function(){return this._stream}},{key:"setStream",value:function(t){this._stream=t}},{key:"stopCamera",value:function(){this._stream&&(this._stream.getTracks().forEach((function(t){return t.stop()})),this._stream=null)}}],e&&Z(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){et=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==tt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(tt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function rt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function nt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rt(i,n,o,a,c,"next",t)}function c(t){rt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,it(n.key),n)}}function it(t){var e=function(t){if("object"!=tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tt(e)?e:e+""}const at=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e},e=[{key:"submitStory",value:(n=nt(et().mark((function t(e){var r;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(r=this._validateStoryData(e))){t.next=5;break}return this._view.showValidationError(r),t.abrupt("return");case 5:return this._view.showSubmitting(),t.prev=6,t.next=9,u.addStory(e);case 9:this._view.showSuccess("Cerita berhasil ditambahkan!"),setTimeout((function(){window.location.hash="#/"}),2e3),t.next=23;break;case 13:if(t.prev=13,t.t0=t.catch(6),navigator.onLine&&!t.t0.message.includes("Failed to fetch")&&!t.t0.message.includes("NetworkError")){t.next=22;break}return t.next=18,this._saveForOfflineSync(e);case 18:this._view.showSuccess("Anda sedang offline. Cerita akan dikirim saat online kembali."),setTimeout((function(){window.location.hash="#/"}),2e3),t.next=23;break;case 22:throw t.t0;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t.catch(0),this._view.showError(t.t1.message||"Gagal menambahkan cerita. Silakan coba lagi.");case 28:case"end":return t.stop()}}),t,this,[[0,25],[6,13]])}))),function(t){return n.apply(this,arguments)})},{key:"_saveForOfflineSync",value:(r=nt(et().mark((function t(e){var r,n,o;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._fileToBase64(e.photo);case 3:return r=t.sent,n={description:e.description,photoBase64:r,photoName:e.photo.name,photoType:e.photo.type,lat:e.lat,lon:e.lon,token:u.getToken(),createdAt:(new Date).toISOString()},t.next=7,O.addOfflineStory(n);case 7:if(!("serviceWorker"in navigator)||!("sync"in navigator.serviceWorker)){t.next=14;break}return t.next=10,navigator.serviceWorker.ready;case 10:return o=t.sent,t.next=13,o.sync.register("sync-stories");case 13:console.log("Background sync registered");case 14:t.next=20;break;case 16:throw t.prev=16,t.t0=t.catch(0),console.error("Failed to save for offline sync:",t.t0),new Error("Gagal menyimpan cerita untuk sinkronisasi offline");case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return r.apply(this,arguments)})},{key:"_fileToBase64",value:function(t){return new Promise((function(e,r){var n=new FileReader;n.onload=function(){return e(n.result)},n.onerror=r,n.readAsDataURL(t)}))}},{key:"_validateStoryData",value:function(t){return t.description&&0!==t.description.trim().length?t.description.trim().length<10?"Deskripsi cerita minimal 10 karakter":t.photo?t.lat&&t.lon?t.photo.size>1048576?"Ukuran foto maksimal 1MB":["image/jpeg","image/jpg","image/png"].includes(t.photo.type)?null:"Format foto harus JPG, JPEG, atau PNG":"Lokasi harus dipilih dengan klik pada peta":"Foto harus dipilih":"Deskripsi cerita tidak boleh kosong"}}],e&&ot(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(){st=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ct(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ct(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ut(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function lt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ut(i,n,o,a,c,"next",t)}function c(t){ut(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function ht(t){var e=function(t){if("object"!=ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ct(e)?e:e+""}const pt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=new X,this._presenter=new at(this._view),this._photoFile=null},e=[{key:"render",value:(i=lt(st().mark((function t(){return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._view.getTemplate());case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=lt(st().mark((function t(){return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._view.initializeMap(),this._initializeFormHandlers(),this._initializeCameraHandlers();case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_initializeFormHandlers",value:function(){var t=this,e=document.querySelector("#add-story-form"),r=document.querySelector("#description"),n=document.querySelector("#photo"),o=document.querySelector("#char-count");r&&o&&r.addEventListener("input",(function(){o.textContent=r.value.length})),n&&n.addEventListener("change",(function(e){var r=e.target.files[0];r&&t._handlePhotoSelection(r)})),document.addEventListener("click",(function(e){("remove-photo-btn"===e.target.id||e.target.closest("#remove-photo-btn"))&&t._removePhoto()})),e&&e.addEventListener("submit",(function(e){e.preventDefault(),t._handleSubmit()}))}},{key:"_initializeCameraHandlers",value:function(){var t=this,e=document.querySelector("#open-camera-btn"),r=document.querySelector("#close-camera-btn"),n=document.querySelector("#capture-btn");e&&e.addEventListener("click",(function(){return t._openCamera()})),r&&r.addEventListener("click",(function(){return t._closeCamera()})),n&&n.addEventListener("click",(function(){return t._capturePhoto()}))}},{key:"_openCamera",value:(n=lt(st().mark((function t(){var e,r,n;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.querySelector("#camera-container"),r=document.querySelector("#camera-video"),t.prev=2,t.next=5,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});case 5:n=t.sent,this._view.setStream(n),r&&(r.srcObject=n),e&&e.classList.remove("hidden"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),console.error("Error accessing camera:",t.t0),alert("Tidak dapat mengakses kamera. Pastikan Anda memberikan izin akses kamera.");case 15:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return n.apply(this,arguments)})},{key:"_closeCamera",value:function(){var t=document.querySelector("#camera-container"),e=document.querySelector("#camera-video");this._view.stopCamera(),e&&(e.srcObject=null),t&&t.classList.add("hidden")}},{key:"_capturePhoto",value:function(){var t=this,e=document.querySelector("#camera-video"),r=document.querySelector("#camera-canvas");e&&r&&(r.width=e.videoWidth,r.height=e.videoHeight,r.getContext("2d").drawImage(e,0,0,r.width,r.height),r.toBlob((function(e){if(e){var r=new File([e],"camera-".concat(Date.now(),".jpg"),{type:"image/jpeg"});t._handlePhotoSelection(r),t._closeCamera()}}),"image/jpeg",.9))}},{key:"_handlePhotoSelection",value:function(t){this._photoFile=t;var e=new FileReader;e.onload=function(t){var e=document.querySelector("#photo-preview"),r=document.querySelector("#photo-preview-container"),n=document.querySelector("#photo-error");e&&r&&(e.src=t.target.result,r.classList.remove("hidden")),n&&(n.textContent="")},e.readAsDataURL(t)}},{key:"_removePhoto",value:function(){this._photoFile=null;var t=document.querySelector("#photo"),e=document.querySelector("#photo-preview"),r=document.querySelector("#photo-preview-container");t&&(t.value=""),e&&(e.src=""),r&&r.classList.add("hidden")}},{key:"_handleSubmit",value:(r=lt(st().mark((function t(){var e,r,n;return st().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.querySelector("#description"),r=this._view.getSelectedLocation(),n={description:(null==e?void 0:e.value)||"",photo:this._photoFile,lat:(null==r?void 0:r.lat)||null,lon:(null==r?void 0:r.lng)||null},t.next=5,this._presenter.submitStory(n);case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function vt(){vt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==dt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(dt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function yt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function mt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){yt(i,n,o,a,c,"next",t)}function c(t){yt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bt(n.key),n)}}function bt(t){var e=function(t){if("object"!=dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dt(e)?e:e+""}const wt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._isLoginMode=!0},e=[{key:"render",value:(i=mt(vt().mark((function t(){return vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <div class="auth-container">\n        <div class="auth-card">\n          <div class="auth-header">\n            <img src="favicon.png" alt="StoryShare Logo" class="auth-logo" />\n            <h1 class="auth-title">StoryShare</h1>\n            <p class="auth-subtitle">Bagikan cerita, bagikan pengalaman</p>\n          </div>\n\n          <div class="auth-tabs" role="tablist">\n            <button id="login-tab" class="auth-tab active" role="tab" aria-label="Tab Login" aria-selected="true" tabindex="0">\n              Login\n            </button>\n            <button id="register-tab" class="auth-tab" role="tab" aria-label="Tab Register" aria-selected="false" tabindex="0">\n              Register\n            </button>\n          </div>\n\n          \x3c!-- Login Form --\x3e\n          <form id="login-form" class="auth-form">\n            <div class="form-group">\n              <label for="login-email" class="form-label">Email <span class="required">*</span></label>\n              <input \n                type="email" \n                id="login-email" \n                class="form-control" \n                placeholder="email@example.com"\n                required\n                autocomplete="email"\n              />\n            </div>\n\n            <div class="form-group">\n              <label for="login-password" class="form-label">Password <span class="required">*</span></label>\n              <input \n                type="password" \n                id="login-password" \n                class="form-control" \n                placeholder="Masukkan password"\n                required\n                autocomplete="current-password"\n              />\n            </div>\n\n            <div id="login-error" class="error-message" role="alert"></div>\n\n            <button type="submit" class="btn btn-primary btn-large btn-block">\n              Login\n            </button>\n          </form>\n\n          \x3c!-- Register Form --\x3e\n          <form id="register-form" class="auth-form hidden">\n            <div class="form-group">\n              <label for="register-name" class="form-label">Nama <span class="required">*</span></label>\n              <input \n                type="text" \n                id="register-name" \n                class="form-control" \n                placeholder="Nama lengkap"\n                required\n                autocomplete="name"\n              />\n            </div>\n\n            <div class="form-group">\n              <label for="register-email" class="form-label">Email <span class="required">*</span></label>\n              <input \n                type="email" \n                id="register-email" \n                class="form-control" \n                placeholder="email@example.com"\n                required\n                autocomplete="email"\n              />\n            </div>\n\n            <div class="form-group">\n              <label for="register-password" class="form-label">Password <span class="required">*</span></label>\n              <input \n                type="password" \n                id="register-password" \n                class="form-control" \n                placeholder="Minimal 8 karakter"\n                required\n                minlength="8"\n                autocomplete="new-password"\n              />\n              <p class="form-help">Password minimal 8 karakter</p>\n            </div>\n\n            <div id="register-error" class="error-message" role="alert"></div>\n            <div id="register-success" class="success-message" role="alert"></div>\n\n            <button type="submit" class="btn btn-primary btn-large btn-block">\n              Register\n            </button>\n          </form>\n        </div>\n      </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=mt(vt().mark((function t(){return vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.isAuthenticated()){t.next=3;break}return window.location.hash="#/",t.abrupt("return");case 3:this._initializeTabHandlers(),this._initializeFormHandlers();case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_initializeTabHandlers",value:function(){var t=this,e=document.querySelector("#login-tab"),r=document.querySelector("#register-tab"),n=document.querySelector("#login-form"),o=document.querySelector("#register-form"),i=function(){e.classList.add("active"),r.classList.remove("active"),n.classList.remove("hidden"),o.classList.add("hidden"),t._isLoginMode=!0,t._clearMessages()},a=function(){r.classList.add("active"),e.classList.remove("active"),o.classList.remove("hidden"),n.classList.add("hidden"),t._isLoginMode=!1,t._clearMessages()};null==e||e.addEventListener("click",i),null==e||e.addEventListener("keypress",(function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i())})),null==r||r.addEventListener("click",a),null==r||r.addEventListener("keypress",(function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),a())}))}},{key:"_initializeFormHandlers",value:function(){var t=this,e=document.querySelector("#login-form"),r=document.querySelector("#register-form");null==e||e.addEventListener("submit",(function(e){e.preventDefault(),t._handleLogin()})),null==r||r.addEventListener("submit",(function(e){e.preventDefault(),t._handleRegister()}))}},{key:"_handleLogin",value:(n=mt(vt().mark((function t(){var e,r,n,o,i,a;return vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null===(e=document.querySelector("#login-email"))||void 0===e?void 0:e.value,o=null===(r=document.querySelector("#login-password"))||void 0===r?void 0:r.value,i=document.querySelector("#login-error"),a=document.querySelector('#login-form button[type="submit"]'),t.prev=4,a&&(a.disabled=!0,a.textContent="Loading..."),i.textContent="",t.next=9,u.login({email:n,password:o});case 9:t.sent,window.location.hash="#/",t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),i.textContent=t.t0.message||"Login gagal. Silakan coba lagi.";case 16:return t.prev=16,a&&(a.disabled=!1,a.textContent="Login"),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[4,13,16,19]])}))),function(){return n.apply(this,arguments)})},{key:"_handleRegister",value:(r=mt(vt().mark((function t(){var e,r,n,o,i,a,c,s,l;return vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null===(e=document.querySelector("#register-name"))||void 0===e?void 0:e.value,i=null===(r=document.querySelector("#register-email"))||void 0===r?void 0:r.value,a=null===(n=document.querySelector("#register-password"))||void 0===n?void 0:n.value,c=document.querySelector("#register-error"),s=document.querySelector("#register-success"),l=document.querySelector('#register-form button[type="submit"]'),t.prev=6,l&&(l.disabled=!0,l.textContent="Loading..."),c.textContent="",s.textContent="",t.next=12,u.register({name:o,email:i,password:a});case 12:s.textContent="Registrasi berhasil! Silakan login.",document.querySelector("#register-name").value="",document.querySelector("#register-email").value="",document.querySelector("#register-password").value="",setTimeout((function(){var t;null===(t=document.querySelector("#login-tab"))||void 0===t||t.click()}),2e3),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(6),c.textContent=t.t0.message||"Registrasi gagal. Silakan coba lagi.";case 22:return t.prev=22,l&&(l.disabled=!1,l.textContent="Register"),t.finish(22);case 25:case"end":return t.stop()}}),t,null,[[6,19,22,25]])}))),function(){return r.apply(this,arguments)})},{key:"_clearMessages",value:function(){document.querySelector("#login-error").textContent="",document.querySelector("#register-error").textContent="",document.querySelector("#register-success").textContent=""}}],e&&gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function kt(){kt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==xt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(xt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Lt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Et(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lt(i,n,o,a,c,"next",t)}function c(t){Lt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function St(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_t(n.key),n)}}function _t(t){var e=function(t){if("object"!=xt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xt(e)?e:e+""}const Ot={"/":K,"/add-story":pt,"/favorites":function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._favorites=[],this._searchQuery="",this._sortBy="date",this._sortOrder="desc"},e=[{key:"render",value:(i=Et(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <div class="favorites-container">\n        <div class="favorites-header">\n          <h1>Cerita Favorit Saya</h1>\n          <p class="favorites-subtitle">Kelola cerita favorit yang telah Anda simpan</p>\n        </div>\n\n        <div class="favorites-controls">\n          <div class="search-box">\n            <input \n              type="search" \n              id="favorites-search" \n              class="form-control search-input" \n              placeholder="Cari cerita favorit..."\n              aria-label="Cari cerita favorit"\n            />\n          </div>\n\n          <div class="sort-controls">\n            <label for="sort-by">Urutkan:</label>\n            <select id="sort-by" class="form-control sort-select">\n              <option value="date">Tanggal</option>\n              <option value="name">Nama</option>\n            </select>\n\n            <select id="sort-order" class="form-control sort-select">\n              <option value="desc">Terbaru</option>\n              <option value="asc">Terlama</option>\n            </select>\n          </div>\n        </div>\n\n        <div id="favorites-content" class="favorites-content">\n          <div class="loading-spinner">Memuat favorit...</div>\n        </div>\n\n        <div id="empty-state" class="empty-state hidden">\n          <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>\n          </svg>\n          <h3>Belum Ada Favorit</h3>\n          <p>Tambahkan cerita ke favorit untuk melihatnya di sini</p>\n          <a href="#/" class="btn btn-primary">Lihat Semua Cerita</a>\n        </div>\n      </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=Et(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._loadFavorites();case 2:this._initializeControls();case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_initializeControls",value:function(){var t,e=this,r=document.querySelector("#favorites-search"),n=document.querySelector("#sort-by"),o=document.querySelector("#sort-order");null==r||r.addEventListener("input",(function(r){clearTimeout(t),t=setTimeout((function(){e._searchQuery=r.target.value,e._displayFavorites()}),300)})),null==n||n.addEventListener("change",(function(t){e._sortBy=t.target.value,"date"===t.target.value?o.innerHTML='\n          <option value="desc">Terbaru</option>\n          <option value="asc">Terlama</option>\n        ':o.innerHTML='\n          <option value="asc">A-Z</option>\n          <option value="desc">Z-A</option>\n        ',e._displayFavorites()})),null==o||o.addEventListener("change",(function(t){e._sortOrder=t.target.value,e._displayFavorites()})),document.addEventListener("click",(function(t){if(t.target.closest(".remove-favorite-btn")){var r=t.target.closest(".remove-favorite-btn").dataset.storyId;e._removeFavorite(r)}}))}},{key:"_loadFavorites",value:(n=Et(kt().mark((function t(){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.getFavorites();case 3:this._favorites=t.sent,this._displayFavorites(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error loading favorites:",t.t0),this._showError("Gagal memuat favorit");case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})},{key:"_displayFavorites",value:function(){var t=this,e=document.querySelector("#favorites-content"),r=document.querySelector("#empty-state"),n=this._favorites;if(this._searchQuery){var o=this._searchQuery.toLowerCase();n=n.filter((function(t){var e,r;return(null===(e=t.name)||void 0===e?void 0:e.toLowerCase().includes(o))||(null===(r=t.description)||void 0===r?void 0:r.toLowerCase().includes(o))}))}if(n.sort((function(e,r){if("name"===t._sortBy){var n,o,i=(null===(n=e.name)||void 0===n?void 0:n.toLowerCase())||"",a=(null===(o=r.name)||void 0===o?void 0:o.toLowerCase())||"";return"desc"===t._sortOrder?a.localeCompare(i):i.localeCompare(a)}var c=new Date(e.favoritedAt||e.createdAt),s=new Date(r.favoritedAt||r.createdAt);return"desc"===t._sortOrder?s-c:c-s})),0===n.length)return e.classList.add("hidden"),r.classList.remove("hidden"),void(this._searchQuery?(r.querySelector("h3").textContent="Tidak Ditemukan",r.querySelector("p").textContent='Tidak ada hasil untuk "'.concat(this._searchQuery,'"')):(r.querySelector("h3").textContent="Belum Ada Favorit",r.querySelector("p").textContent="Tambahkan cerita ke favorit untuk melihatnya di sini"));e.classList.remove("hidden"),r.classList.add("hidden"),e.innerHTML=n.map((function(t){return'\n      <div class="favorite-card" data-story-id="'.concat(t.id,'">\n        <div class="favorite-image">\n          <img src="').concat(t.photoUrl,'" alt="').concat(t.name,'" loading="lazy" />\n        </div>\n        <div class="favorite-content">\n          <h3 class="favorite-title">').concat(t.name,'</h3>\n          <p class="favorite-description">').concat(t.description,'</p>\n          <div class="favorite-meta">\n            <span class="favorite-date">\n              Ditambahkan: ').concat(d(t.favoritedAt||t.createdAt,"id-ID"),"\n            </span>\n            ").concat(t.lat&&t.lon?'\n              <span class="favorite-location">\n                📍 '.concat(t.lat.toFixed(4),", ").concat(t.lon.toFixed(4),"\n              </span>\n            "):"",'\n          </div>\n          <div class="favorite-actions">\n            <button \n              class="btn btn-sm btn-outline remove-favorite-btn" \n              data-story-id="').concat(t.id,'"\n              aria-label="Hapus dari favorit"\n            >\n              Hapus dari Favorit\n            </button>\n          </div>\n        </div>\n      </div>\n    ')})).join("")}},{key:"_removeFavorite",value:(r=Et(kt().mark((function t(e){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm("Hapus cerita dari favorit?")){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,O.removeFavorite(e);case 5:this._favorites=this._favorites.filter((function(t){return t.id!==e})),this._displayFavorites(),this._showSuccess("Cerita dihapus dari favorit"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("Error removing favorite:",t.t0),this._showError("Gagal menghapus dari favorit");case 14:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(t){return r.apply(this,arguments)})},{key:"_showError",value:function(t){document.querySelector("#favorites-content").innerHTML='\n      <div class="error-message">\n        <p>'.concat(t,"</p>\n      </div>\n    ")}},{key:"_showSuccess",value:function(t){var e=document.createElement("div");e.className="toast-notification success",e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.classList.add("show")}),100),setTimeout((function(){e.classList.remove("show"),setTimeout((function(){return e.remove()}),300)}),3e3)}}],e&&St(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}(),"/login":wt};function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Pt(){Pt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==jt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(jt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Tt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Nt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Tt(i,n,o,a,c,"next",t)}function c(t){Tt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,At(n.key),n)}}function At(t){var e=function(t){if("object"!=jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jt(e)?e:e+""}const Gt=function(){return t=function t(e){var r=e.drawer,n=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._drawer=r,this._content=n,this._initialAppShell()},e=[{key:"_initialAppShell",value:function(){l.init({button:this._drawer.button,nav:this._drawer.nav})}},{key:"renderPage",value:(r=Nt(Pt().mark((function t(){var e,r,n,o=this;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=location.hash.replace("#","")||"/",s=void 0,s=c.split("/"),i={resource:s[1]||null,id:s[2]||null},a=void 0,a="",i.resource&&(a=a.concat("/".concat(i.resource))),i.id&&(a=a.concat("/:id")),["/login"].includes(e=a||"/")||u.isAuthenticated()){t.next=5;break}return window.location.hash="#/login",t.abrupt("return");case 5:if(!(r=Ot[e])){t.next=20;break}if(n=new r,!document.startViewTransition){t.next=12;break}document.startViewTransition(Nt(Pt().mark((function t(){return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.render();case 2:return o._content.innerHTML=t.sent,t.next=5,n.afterRender();case 5:o._scrollToTop();case 6:case"end":return t.stop()}}),t)})))),t.next=18;break;case 12:return t.next=14,n.render();case 14:return this._content.innerHTML=t.sent,t.next=17,n.afterRender();case 17:this._scrollToTop();case 18:t.next=21;break;case 20:this._content.innerHTML='\n        <div class="container">\n          <div class="error-container">\n            <h2>404 - Halaman Tidak Ditemukan</h2>\n            <p>Maaf, halaman yang Anda cari tidak ada.</p>\n            <a href="#/" class="btn btn-primary mt-2">Kembali ke Beranda</a>\n          </div>\n        </div>\n      ';case 21:case"end":return t.stop()}var i,a,c,s}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_scrollToTop",value:function(){window.scrollTo({top:0,behavior:"smooth"})}}],e&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function qt(){qt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Ct(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ct(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function It(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Dt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){It(i,n,o,a,c,"next",t)}function c(t){It(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bt(n.key),n)}}function Bt(t){var e=function(t){if("object"!=Ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ct(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ct(e)?e:e+""}const Ht=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.registration=null,this.subscription=null},r=[{key:"isSupported",value:function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}},{key:"getPermission",value:function(){return"Notification"in window?Notification.permission:"denied"}},{key:"requestPermission",value:(l=Dt(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isSupported()){t.next=2;break}throw new Error("Push notifications are not supported");case 2:return t.next=4,Notification.requestPermission();case 4:return e=t.sent,t.abrupt("return",e);case 6:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"init",value:(u=Dt(qt().mark((function t(e){var r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isSupported()){t.next=3;break}return console.warn("Push notifications not supported"),t.abrupt("return",!1);case 3:return this.registration=e,t.next=6,this.registration.pushManager.getSubscription();case 6:if(!(r=t.sent)){t.next=11;break}return this.subscription=r,console.log("Already subscribed to push notifications"),t.abrupt("return",!0);case 11:return t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"subscribe",value:(s=Dt(qt().mark((function t(){var r,n;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.registration){t.next=2;break}throw new Error("Service Worker not registered");case 2:if("granted"===this.getPermission()){t.next=8;break}return t.next=5,this.requestPermission();case 5:if("granted"===t.sent){t.next=8;break}throw new Error("Notification permission denied");case 8:if(t.prev=8,r=e){t.next=12;break}throw new Error("VAPID public key not configured");case 12:return n=this.urlBase64ToUint8Array(r),t.next=15,this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n});case 15:return this.subscription=t.sent,console.log("Subscribed to push notifications:",this.subscription),t.next=19,this.sendSubscriptionToServer(this.subscription);case 19:return t.abrupt("return",this.subscription);case 22:throw t.prev=22,t.t0=t.catch(8),console.error("Failed to subscribe to push notifications:",t.t0),t.t0;case 26:case"end":return t.stop()}}),t,this,[[8,22]])}))),function(){return s.apply(this,arguments)})},{key:"unsubscribe",value:(c=Dt(qt().mark((function t(){var e,r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.subscription){t.next=8;break}return t.next=3,null===(e=this.registration)||void 0===e?void 0:e.pushManager.getSubscription();case 3:if(r=t.sent){t.next=7;break}return console.log("Not subscribed to push notifications"),t.abrupt("return",!1);case 7:this.subscription=r;case 8:return t.prev=8,t.next=11,this.subscription.unsubscribe();case 11:return console.log("Unsubscribed from push notifications"),t.next=14,this.removeSubscriptionFromServer(this.subscription);case 14:return this.subscription=null,t.abrupt("return",!0);case 18:throw t.prev=18,t.t0=t.catch(8),console.error("Failed to unsubscribe:",t.t0),t.t0;case 22:case"end":return t.stop()}}),t,this,[[8,18]])}))),function(){return c.apply(this,arguments)})},{key:"isSubscribed",value:(a=Dt(qt().mark((function t(){var e;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.registration){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,this.registration.pushManager.getSubscription();case 4:return e=t.sent,t.abrupt("return",!!e);case 6:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}},{key:"sendSubscriptionToServer",value:(i=Dt(qt().mark((function t(e){var r,n,o;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=localStorage.getItem("authToken")){t.next=5;break}return console.warn("No auth token found, skipping subscription send"),t.abrupt("return",!0);case 5:return t.next=7,fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({subscription:e.toJSON()})});case 7:if((n=t.sent).ok){t.next=10;break}throw new Error("Failed to subscribe: ".concat(n.status));case 10:return t.next=12,n.json();case 12:return o=t.sent,console.log("Push subscription sent to server:",o),t.abrupt("return",!0);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Error sending subscription to server:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,17]])}))),function(t){return i.apply(this,arguments)})},{key:"removeSubscriptionFromServer",value:(o=Dt(qt().mark((function t(e){var r;return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=localStorage.getItem("authToken")){t.next=5;break}return console.warn("No auth token found, skipping unsubscribe"),t.abrupt("return");case 5:return t.next=7,fetch("https://story-api.dicoding.dev/v1/notifications/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({subscription:e.toJSON()})});case 7:t.sent.ok?console.log("Successfully unsubscribed from server"):console.warn("Failed to unsubscribe from server, but continuing locally"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error removing subscription from server:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(t){return o.apply(this,arguments)})},{key:"testNotification",value:(n=Dt(qt().mark((function t(){return qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("granted"===this.getPermission()){t.next=6;break}return t.next=3,this.requestPermission();case 3:if("granted"===t.sent){t.next=6;break}throw new Error("Permission denied");case 6:if(new Notification("StoryShare Test",{body:"Push notification berhasil diaktifkan!",icon:"./favicon.png",badge:"./favicon.png"}),!this.registration){t.next=10;break}return t.next=10,this.registration.showNotification("StoryShare SW Test",{body:"Service Worker notification test",icon:"./favicon.png",badge:"./favicon.png"});case 10:return t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],r&&Mt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o,i,a,c,s,u,l}());function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function zt(){zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new T(n||[]);return o(a,"_invoke",{value:_(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Rt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=O(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function O(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,O(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Rt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Yt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Yt(i,n,o,a,c,"next",t)}function c(t){Yt(i,n,o,a,c,"throw",t)}a(void 0)}))}}var Vt,Wt=new Gt({drawer:{button:document.querySelector("#drawer-button"),nav:document.querySelector("#navigation-drawer")},content:document.querySelector("#main-content")});O.init().catch((function(t){console.error("Failed to initialize IndexedDB:",t)})),document.addEventListener("DOMContentLoaded",(function(){var t=document.querySelector(".skip-to-content"),e=document.querySelector("#main-content");t&&e&&t.addEventListener("click",(function(t){t.preventDefault(),e.setAttribute("tabindex","-1"),e.focus(),e.scrollIntoView({behavior:"smooth",block:"start"}),e.addEventListener("blur",(function(){e.removeAttribute("tabindex")}),{once:!0})}))})),window.addEventListener("DOMContentLoaded",(function(){Wt.renderPage()})),window.addEventListener("hashchange",(function(){Wt.renderPage()}));var Jt=!1;window.addEventListener("beforeinstallprompt",(function(t){console.log("beforeinstallprompt event fired"),t.preventDefault(),Vt=t,Jt||function(){if(!document.getElementById("install-btn"))if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)console.log("App is already installed");else{var t=document.createElement("button");t.className="install-btn",t.id="install-btn",t.innerHTML='\n    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>\n      <polyline points="7 10 12 15 17 10"></polyline>\n      <line x1="12" y1="15" x2="12" y2="3"></line>\n    </svg>\n    <span>Install App</span>\n  ',t.addEventListener("click",Ut(zt().mark((function e(){var r,n;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Vt){e.next=2;break}return e.abrupt("return");case 2:return Vt.prompt(),e.next=5,Vt.userChoice;case 5:r=e.sent,n=r.outcome,console.log("User response to install prompt: ".concat(n)),"accepted"===n&&(Jt=!0),Vt=null,t.remove();case 11:case"end":return e.stop()}}),e)})))),document.body.appendChild(t),Jt=!0}}()})),window.addEventListener("appinstalled",(function(){console.log("PWA was installed"),Vt=null,Jt=!0;var t=document.getElementById("install-btn");t&&t.remove()})),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&(console.log("App is running in standalone mode"),Jt=!0),"serviceWorker"in navigator&&window.addEventListener("load",Ut(zt().mark((function t(){var e;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.register("./sw.js");case 3:return e=t.sent,console.log("Service Worker registered:",e),t.next=7,navigator.serviceWorker.ready;case 7:if("default"!==Notification.permission){t.next=10;break}return t.next=10,Notification.requestPermission();case 10:return t.next=12,Ht.init(e);case 12:if(t.sent||"granted"!==Notification.permission){t.next=23;break}return t.prev=14,t.next=17,Ht.subscribe();case 17:console.log("Auto-subscribed to push notifications"),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14),console.log("Auto-subscribe failed:",t.t0);case 23:window.swRegistration=e,t.next=29;break;case 26:t.prev=26,t.t1=t.catch(0),console.error("Service Worker registration failed:",t.t1);case 29:case"end":return t.stop()}}),t,null,[[0,26],[14,20]])})))),document.addEventListener("click",(function(t){"logout-btn"===t.target.id&&(t.preventDefault(),u.logout())}))})();